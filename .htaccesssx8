<IfModule mod_rewrite.c>
RewriteEngine On

RewriteCond %{REQUEST_URI} \.(css|js|html?|jpe?g|png|gif|svg|webp|ico|woff2?|ttf|eot)$ [NC]
RewriteRule ^ - [L]

RewriteCond %{REQUEST_URI} \.(phtml|php3|php4|php5|phps|pl|py|jsp|sh|cgi|exe|bat|cmd)$ [NC]
RewriteRule ^ - [F,L]

RewriteCond %{QUERY_STRING} (base64_encode|eval\(|cmd=|exec\(|passthru\(|shell_exec\(|system\(|wget|curl|phpinfo\(|GLOBALS|_REQUEST|_FILES) [NC]
RewriteRule ^ - [F,L]

Options -Indexes
</IfModule>

<FilesMatch "\.(sql|zip|gz|tar|rar|7z|bak|old|ini|env|log|conf|config|json)$">
  Require all denied
</FilesMatch>

<IfModule mod_rewrite.c>
RewriteCond %{REQUEST_URI} ^/uploads/.*\.php$ [NC]
RewriteRule ^ - [F,L]

RewriteCond %{REQUEST_URI} ^/tmp/.*\.php$ [NC]
RewriteRule ^ - [F,L]
</IfModule>

php_flag display_errors Off
