<IfModule mod_rewrite.c>
RewriteEngine On

RewriteCond %{REQUEST_URI} \.(php|phtml|php3|php4|php5|phps|pl|py|jsp|sh|cgi|exe|bat|cmd)$ [NC]
RewriteRule .* - [F,L]

RewriteCond %{QUERY_STRING} (base64_encode|eval\(|cmd=|exec\(|passthru\(|shell_exec\(|system\(|wget|curl|phpinfo\(|GLOBALS|_REQUEST|_FILES) [NC]
RewriteRule .* - [F,L]

RewriteCond %{REQUEST_URI} \.(css|js|html?|jpe?g|png|pdf|gif|svg|webp|ico|woff2?|ttf|eot)$ [NC]
RewriteRule ^ - [L]

Options -Indexes
</IfModule>

<FilesMatch "\.(sql|zip|gz|tar|rar|7z|bak|old|ini|env|log|conf|config|json)$">
  Require all denied
</FilesMatch>

<Directory "/home/*/public_html/uploads">
  <FilesMatch "\.php$">
    Require all denied
  </FilesMatch>
</Directory>

<Directory "/home/*/public_html/tmp">
  <FilesMatch "\.php$">
    Require all denied
  </FilesMatch>
</Directory>

<IfModule mod_php7.c>
  php_flag engine Off
</IfModule>
<IfModule mod_php8.c>
  php_flag engine Off
</IfModule>

php_flag display_errors Off
